<div class="timeline-sidebar-container h-100 position-relative" [class.mini]="!isOpen">
  <!-- Toggle & Header -->
  <div
    class="d-flex align-items-center mb-4 pt-1"
    [class.justify-content-between]="isOpen"
    [class.justify-content-center]="!isOpen"
  >
    @if (isOpen) {
      <label class="text-secondary small fw-bold mb-0">{{ getContent().monthLabel }}</label>
    }
    <button
      class="btn btn-light-soft rounded-3 p-1 px-2 d-flex align-items-center justify-content-center shadow-sm border"
      (click)="toggleSidebar.emit()"
      [title]="langService.isAr() ? (isOpen ? 'إغلاق' : 'فتح') : isOpen ? 'Close' : 'Open'"
    >
      <i
        class="bi fs-5"
        [class.bi-layout-sidebar]="isOpen"
        [class.bi-layout-sidebar-reverse]="!isOpen && !langService.isAr()"
        [class.bi-layout-sidebar-inset-reverse]="!isOpen && langService.isAr()"
      ></i>
    </button>
  </div>

  @if (isOpen) {
    <div class="mb-4">
      <label class="text-secondary small fw-bold mb-2 d-block">{{ getContent().yearLabel }}</label>
      <div class="year-card d-flex align-items-center justify-content-between p-2 rounded-3 border">
        <button class="btn btn-outline-secondary border-0 btn-sm" (click)="changeYear(-1)">
          <i class="bi" [ngClass]="langService.isAr() ? 'bi-chevron-right' : 'bi-chevron-left'"></i>
        </button>
        <span class="fw-bold fs-6">{{ currentYear() }}</span>
        <button class="btn btn-outline-secondary border-0 btn-sm" (click)="changeYear(1)">
          <i class="bi" [ngClass]="langService.isAr() ? 'bi-chevron-left' : 'bi-chevron-right'"></i>
        </button>
      </div>
    </div>

    <!-- Month List -->
    <div>
      <div class="month-list d-flex flex-column gap-1">
        @for (month of getContent().months; track month; let i = $index) {
          <button
            class="month-item btn d-flex align-items-center justify-content-between py-1 px-3 rounded-3"
            [class.active]="selectedMonth() === i"
            (click)="selectMonth(i)"
          >
            <span class="fw-bold">{{ month }}</span>
            <i
              class="bi"
              [class.bi-calendar3]="selectedMonth() !== i"
              [class.bi-calendar-check]="selectedMonth() === i"
            ></i>
          </button>
        }
      </div>
    </div>
  } @else {
    <!-- Mini Summary -->
    <div class="d-flex flex-column align-items-center gap-4 mt-4 text-secondary">
      <div class="mini-year fw-bold fs-6 rotate-text">{{ currentYear() }}</div>
      <div class="mini-month bg-dark text-white rounded-3 p-2 fw-bold shadow">
        {{ selectedMonth() + 1 }}
      </div>
    </div>
  }
</div>
